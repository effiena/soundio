<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>SOUNDIO</title>

<link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='soundio.ico') }}">
<link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='soundiologo.png') }}">
<link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Soundio">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<script>
document.addEventListener("DOMContentLoaded", () => {

    const player = document.getElementById("player");
    const titleEl = document.getElementById("current-song");
    const playlistItems = document.querySelectorAll("#playlist li");
    const playBtn = document.getElementById("play-pause-btn");
    const stopBtn = document.getElementById("stop-btn");
    const nextBtn = document.getElementById("next-btn");
    const prevBtn = document.getElementById("prev-btn");
    const shuffleBtn = document.getElementById("shuffle-btn");
    const repeatBtn = document.getElementById("repeat-btn");
    const filter = document.getElementById("genre-filter");

    let index = 0;
    let repeat = false;
    let isPlaying = false;

    function loadSong(i){
        const visibleItems = getVisibleSongs();
        if(!visibleItems[i]) return;

        visibleItems.forEach(li=>li.classList.remove("active"));
        visibleItems[i].classList.add("active");

        const src = visibleItems[i].dataset.src;
        const name = visibleItems[i].textContent;

        player.src = encodeURI(src);
        player.play();

        titleEl.textContent = "ðŸŽ¶ Now Playing: " + name;
        index = i;
        isPlaying = true;
    }

    function getVisibleSongs(){
        return Array.from(document.querySelectorAll("#playlist li"))
            .filter(li => li.style.display !== "none");
    }

    playlistItems.forEach((li)=>{
        li.addEventListener("click", ()=>{
            const visible = getVisibleSongs();
            index = visible.indexOf(li);
            loadSong(index);
        });
    });

    playBtn.onclick = ()=>{
        if(!player.src){
            loadSong(0);
            return;
        }
        if(isPlaying){
            player.pause();
            playBtn.textContent="â–¶ï¸";
        }else{
            player.play();
            playBtn.textContent="â¸";
        }
        isPlaying = !isPlaying;
    };

    stopBtn.onclick = ()=>{
        player.pause();
        player.currentTime=0;
        isPlaying=false;
        playBtn.textContent="â–¶ï¸";
    };

    nextBtn.onclick = ()=>{
        const visible = getVisibleSongs();
        index = (index+1)%visible.length;
        loadSong(index);
    };

    prevBtn.onclick = ()=>{
        const visible = getVisibleSongs();
        index = (index-1+visible.length)%visible.length;
        loadSong(index);
    };

    shuffleBtn.onclick = ()=>{
        const visible = getVisibleSongs();
        index = Math.floor(Math.random()*visible.length);
        loadSong(index);
    };

    repeatBtn.onclick = ()=>{
        repeat = !repeat;
        alert("Repeat "+(repeat?"ON":"OFF"));
    };

    player.addEventListener("ended", ()=>{
        const visible = getVisibleSongs();
        if(repeat){
            loadSong(index);
        }else{
            index = (index+1)%visible.length;
            loadSong(index);
        }
    });

    /* ðŸŽ§ FILTER SYSTEM */
    filter.addEventListener("change", ()=>{
        const value = filter.value.toLowerCase();

        playlistItems.forEach(li=>{
            const name = li.textContent.toLowerCase();

            if(value === "all"){
                li.style.display = "block";
            }
            else if(name.includes(value)){
                li.style.display = "block";
            }
            else{
                li.style.display = "none";
            }
        });

        index = 0;
    });

});
</script>
<!--
<div style="margin-top:20px;">
    <button onclick="alert('SOUNDIO Music App Â© 2026 by Asli.Tech');" style="padding:8px 12px; border-radius:6px; border:none; background:#8c9352; color:#F4F1DE; cursor:pointer;">
        About Us
    </button>
</div>
-->
<footer style="text-align:center; padding:10px; font-size:14px; color:#555;">
    Â© 2026 Soundio Music App. All rights reserved. <br>
   <a> Created by Asli.Tech</a>
<a href="/license.txt" target="_blank">SOUNDIO Music App License</a>
</footer>

</body>
</html>
