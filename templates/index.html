<div id="logo-container">
  <img src="{{ url_for('static', filename='picture/soundiologo.png') }}" id="soundio-logo">
</div>

<style>
#logo-container { 
  position: relative; 
  height: 150px; /* space for side-to-side motion */
}

#soundio-logo {
  position: absolute;
  width: 110px;
  aspect-ratio:1/1;
  border-radius:50%;
  object-fit:cover;
  top:50px; /* vertical center in container */
  left:50%;
  transform: translateX(-50%);
  box-shadow:0 0 10px rgba(230,194,41,0.5);
  transition: box-shadow 0.05s linear;
}
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {

const logo = document.getElementById("soundio-logo");
let audioCtx, analyser, source, dataArray;

function initAudio(player){
  if(audioCtx) return;
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  source = audioCtx.createMediaElementSource(player);
  analyser = audioCtx.createAnalyser();
  source.connect(analyser);
  analyser.connect(audioCtx.destination);
  analyser.fftSize = 256;
  dataArray = new Uint8Array(analyser.frequencyBinCount);
  animateLogo();
}

// Pulsing + side-to-side half-circle motion
function animateLogo(){
  if(!analyser) return;
  requestAnimationFrame(animateLogo);

  analyser.getByteFrequencyData(dataArray);
  let avg = dataArray.reduce((a,b)=>a+b,0)/dataArray.length;

  // Pulse scale
  let scale = 0.9 + (avg/255)*0.3;

  // Half-circle horizontal motion: 3 o'clock â†’ 9 o'clock
  const radius = 60; // half-circle radius
  const angle = Math.PI * (0.5 + 0.5 * Math.sin(Date.now()/1500)); // oscillate side-to-side
  const x = radius * Math.cos(angle);

  logo.style.transform = `translateX(${x}px) scale(${scale})`;
  logo.style.boxShadow = `0 0 ${avg/255*20}px rgba(230,194,41,0.8)`;
}

});
</script>
